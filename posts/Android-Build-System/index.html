<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="android build system" /><meta name="author" content="Mista" /><meta property="og:locale" content="en_US" /><meta name="description" content="最近，集成杜比音效用到了很多Android编译知识，记录一下" /><meta property="og:description" content="最近，集成杜比音效用到了很多Android编译知识，记录一下" /><link rel="canonical" href="https://fgroove.github.io/longan/posts/Android-Build-System/" /><meta property="og:url" content="https://fgroove.github.io/longan/posts/Android-Build-System/" /><meta property="og:site_name" content="Mista’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-13T21:55:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="android build system" /><meta name="twitter:site" content="@STRONGYASAI" /><meta name="twitter:creator" content="@Mista" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mista"},"dateModified":"2022-07-21T02:07:30+08:00","datePublished":"2022-07-13T21:55:00+08:00","description":"最近，集成杜比音效用到了很多Android编译知识，记录一下","headline":"android build system","mainEntityOfPage":{"@type":"WebPage","@id":"https://fgroove.github.io/longan/posts/Android-Build-System/"},"url":"https://fgroove.github.io/longan/posts/Android-Build-System/"}</script><title>android build system | Mista's Blog</title><link rel="shortcut icon" href="/longan/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/longan/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/longan/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/longan/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/longan/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/longan/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/longan/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/longan/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/longan/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/longan/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/longan/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/longan/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/longan/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/longan/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/longan/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/longan/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/longan/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/longan/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/longan/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/longan/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/longan/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/longan/assets/js/dist/post.min.js"></script> <script defer src="/longan/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/longan/" alt="avatar" class="mx-auto"> <img src="/longan/assets/img/oruka.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/longan/">Mista's Blog</a></div><div class="site-subtitle font-italic">recording and summing up</div></div><ul class="w-100"><li class="nav-item"> <a href="/longan/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/longan/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/longan/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/longan/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/longan/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/fgroove" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/STRONGYASAI" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cai1527106237','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/longan/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/longan/"> Posts </a> </span> <span>android build system</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>android build system</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mista </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jul 13, 2022, 9:55 PM +0800" prep="on" > Jul 13, 2022 <i class="unloaded">2022-07-13T21:55:00+08:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 21, 2022, 2:07 AM +0800" prefix="Updated " > Jul 21, 2022 <i class="unloaded">2022-07-21T02:07:30+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1560 words">8 min</span></div></div><div class="post-content"><p>最近，集成杜比音效用到了很多Android编译知识，记录一下</p><ol><li>Android编译系统，Android.bp、Soong以及Android.mk<li>Android.bp语法记录，vintf-fragments字段等<li>Android HIDL使用实例</ol><h2 id="android-构造系统">Android 构造系统</h2><p>AOSP源码<a href="https://android.googlesource.com/platform/build/+/refs/heads/master"><code class="language-plaintext highlighter-rouge">build/README.md</code></a>,</p><blockquote><p>This is the Makefile-based portion of the Android Build System.</p><p>For documentation on how to run a build, see <a href="https://android.googlesource.com/platform/build/+/refs/heads/master/Usage.txt">Usage.txt</a></p><p>For a list of behavioral changes useful for Android.mk writers see <a href="https://android.googlesource.com/platform/build/+/refs/heads/master/Changes.md">Changes.md</a></p><p>For an outdated reference on Android.mk files, see <a href="https://android.googlesource.com/platform/build/+/refs/heads/master/core/build-system.html">build-system.html</a>. Our Android.mk files look similar, but are entirely different from the Android.mk files used by the NDK build system. When searching for documentation elsewhere, ensure that it is for the platform build system – most are not.</p><p>This Makefile-based system is in the process of being replaced with <a href="https://android.googlesource.com/platform/build/soong/+/master">Soong</a>, a new build system written in Go. During the transition, all of these makefiles are read by <a href="https://github.com/google/kati">Kati</a>, and generate a ninja file instead of being executed directly. That’s combined with a ninja file read by Soong so that the build graph of the two systems can be combined and run as one.</p></blockquote><p>Android 构造系统演进历史大概：</p><ul><li>Android 6.0（包括6.0）之前采用的是纯 Makefile 编译，<li>Android 7.0 开始引入Soong，希望加速 Make；但由于改动太大，所以到目前为止 Soong 并没有完全取代 Make，直到<li>Android 13.0 为止还是 Make 和 Soong 两者兼容的系统。但是 Soong 是主流，未来也会全面取代 Make。</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/Fgroove/longan/master/assets/img/aosp_build_procedure.png" alt="img" /></p><p>Soong 引入后的编译流程如下：</p><ol><li><strong>Soong 的自举（bootstrap）</strong>，编译 Soong 的核心组件，从源码开始构建 Soong 子系统。<li>Android.bp，Soong 框架下的模块会在目录下提供一个 Android.bp 文件。Soong 会扫描收集所有的 Android.bp ，通过 Soong 中的 <strong>Blueprint</strong> 子模块处理 bp 文件语法，生成 <code class="language-plaintext highlighter-rouge">out/soong/build.ninja</code> 文件。<li>Android.mk，Makefile 框架下的模块目录下会有 Android.mk 文件，有 <strong>Kati</strong> 程序负责收集所有的 Android.mk，并生成 <code class="language-plaintext highlighter-rouge">out/build-&lt;product&gt;.ninja</code> 文件，高通平台一般是<code class="language-plaintext highlighter-rouge">out/build-qssi.ninja</code>。<li>Soong 负责将两个 ninja 文件组合成 <code class="language-plaintext highlighter-rouge">out/combined-&lt;product&gt;.ninja</code> 文件，作为最终编译执行的输入文件，调用 gcc 等工具完成最终编译。</ol><h2 id="相关技术">相关技术</h2><h3 id="ninja">Ninja</h3><p>Ninja（日语中的 “忍者 にんじゃ”）是一个致力于速度的小型编译驱动 （类似于 Make）；它去除了 Make 编译过程的复杂的条件判断处理，只保留了对构建步骤的描述。</p><p>它具备两个主要特点：</p><p>1、简单，因为只保留了非常基本的对 build 操作的描述，所以执行 ninja 所花费的时间可以压缩到极致。但这也意味着对于复杂的项目，ninja 必须依赖于其他 “前端” 程序，一般是采用像 python 或者 go 等高级语言构造的更高一层的处理工具完成对项目编译步骤的前期处理，生成 build.ninja 这样的构建步骤描述文件供 ninja 完成最终的编译操作。</p><p>2、快速，它的设计目标就是为了更快的编译，所以在功能实现上除了简单，如果和快速的目标有冲突则优先考虑快速。</p><p>Ninja 核心是由 C/C++ 编写的，同时有一部分辅助功能由 python 和 shell 实现。由于其开源性， 所以可以利用 ninja 的开源代码进行各种个性化的编译定制。Ninja 的代码仓库地址：<a href="https://gitee.com/link?target=https%3A%2F%2Fgithub.com%2Fninja-build%2Fninja">https://github.com/ninja-build/ninja</a>。</p><p>Android 引入 Ninja 的主要目的就是为了加快编译速度。作为在具体生成 ninja 文件的前端，Google 自创了 Soong 框架。</p><h3 id="soong-和-blueprint">Soong 和 Blueprint</h3><p>Soong 是 Google 采用 Go 语言搭建的一个项目构建体系，和 ninja 一起用于替代原先的基于 make 的构建体系。Blueprint 和 Soong 都是由 Golang 写的项目。从 Android 7.0 开始，<code class="language-plaintext highlighter-rouge">prebuilts/go/</code> 目录下新增了 Golang 所需的运行环境，在编译时使用。</p><p>Soong 的源码在 AOSP 源码目录 <code class="language-plaintext highlighter-rouge">build/soong</code> 下；AOSP 源码关于 Soong 的介绍，<code class="language-plaintext highlighter-rouge">build/soong/README.md</code>，</p><blockquote><p>The Soong build system was introduced in Android 7.0 (Nougat) to replace Make. It leverages the Kati GNU Make clone tool and Ninja build system component to speed up builds of Android.</p></blockquote><p>和基于 make 需要写 Makefile（在 AOSP 里是 Android.mk）一样，基于 Soong 需要为每个模块编写 Android.bp 文件来描述组件中各个编译目标（以 module 为单位）之间的依赖关系和组成。之所以后缀名为 <code class="language-plaintext highlighter-rouge">.bp</code> 是因为 <code class="language-plaintext highlighter-rouge">Android.bp</code> 采用了一种叫做 <strong>Blueprint</strong> 语法， 这种语法格式类似于 <a href="https://gitee.com/link?target=https%3A%2F%2Fdocs.bazel.build%2Fversions%2Fmaster%2Fbe%2Foverview.html">Bazel BUILD files</a>。</p><p>对 BP 语法的解析由一个独立的 Blueprint 模块完成，Blueprint 的源码在 AOSP 源码的 <code class="language-plaintext highlighter-rouge">build/blueprint</code> 目录下。该模块相对比较独立，可以单独编译、使用。<strong>任何实际的应用系统都可以在 Blueprint 的基础上定制自己语法。而在 Android 系统上，这个实际的应用系统就是 Soong。 所以说 Soong 是 Android 强相关的，而 Blueprint 实际上相对独立一些</strong>，开发者也可以基于 Blueprint 模块开发自己的应用系统。</p><p>因为 Android 在 Blueprint 的基础上定制了自己的 Soong 系统。所以针对 AOSP，其自身定义 了一套 Android 私有的 BP 语法，可以参考 AOSP 官方文档 <a href="https://gitee.com/link?target=https%3A%2F%2Fsource.android.google.cn%2Fsetup%2Fbuild%23androidbp_file_format">“Android.bp file format”</a> 了解详细内容。</p><h3 id="kati">Kati</h3><p>代码在 AOSP 源码的 <code class="language-plaintext highlighter-rouge">build/kati</code> 目录下。如果想对 Kati 有更多了解，可以阅读 AOSP 源 码下的 <code class="language-plaintext highlighter-rouge">build/kati/README.md</code> 和 <code class="language-plaintext highlighter-rouge">build/kati/INTERNALS.md</code> 文件。</p><p>大概的情况是 Kati 出现得比 Soong 要早，当初担负了加速 AOSP 编译的重任。</p><blockquote><p>kati is an experimental GNU make clone. The main goal of this tool is to speed-up incremental build of Android.</p></blockquote><p>随着 Soong 的出现以及成熟，Kati 的角色也发生了转变，目前退化为仅用于处理遗留的基于 make 的 <code class="language-plaintext highlighter-rouge">.mk</code> 文件，将其转换 ninja 文件。</p><blockquote><p>Currently, kati does not offer a faster build by itself. It instead converts your Makefile to a ninja file.</p></blockquote><p>注意当前的 Kati 程序是由 C++ 编写的，而非 Google 官方御用的 Go。大致的历史是早期的 Kati 的确是用 Go 编写的，但因为 Go 的某些 “低效” 原因，开发团队最后还是选择了 C++， 所以目前的 Kati 有时候又叫 CKati。</p><p>所以只需主要关心 Soong，对 Kati 的了解就到此即可。</p><p>参考：</p><p><a href="https://gitee.com/aosp-riscv/working-group/blob/master/articles/20201230-android-build-sum.md">AOSP Build 背后涉及的相关知识汇总</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/longan/categories/android/'>Android</a>, <a href='/longan/categories/build/'>build</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/longan/tags/android-build-system/" class="post-tag no-text-decoration" >android build system</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=android build system - Mista's Blog&url=https://fgroove.github.io/longan/posts/Android-Build-System/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=android build system - Mista's Blog&u=https://fgroove.github.io/longan/posts/Android-Build-System/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=android build system - Mista's Blog&url=https://fgroove.github.io/longan/posts/Android-Build-System/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/longan/posts/Audio-Volume/">audio volume</a><li><a href="/longan/posts/Android-HIDL-Example/">Android HAL 与 HIDL 开发实例</a><li><a href="/longan/posts/Android.bp-syntax/">Android.bp syntax and usecase</a><li><a href="/longan/posts/Android-Audio-Framework/">Android audio framework</a><li><a href="/longan/posts/Audio-Performance-systrace/">audio performance - systrace</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/longan/tags/audio-playback/">audio playback</a> <a class="post-tag" href="/longan/tags/android-build-system/">android build system</a> <a class="post-tag" href="/longan/tags/android-hidl/">android HIDL</a> <a class="post-tag" href="/longan/tags/android-bp-syntax/">android.bp syntax</a> <a class="post-tag" href="/longan/tags/android-bp/">android.bp</a> <a class="post-tag" href="/longan/tags/array/">array</a> <a class="post-tag" href="/longan/tags/audio-framework/">audio framework</a> <a class="post-tag" href="/longan/tags/audio-playback-record/">audio playback/record</a> <a class="post-tag" href="/longan/tags/audio-stability/">audio stability</a> <a class="post-tag" href="/longan/tags/audio-volume/">audio volume</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/longan/posts/Android.bp-makefile-soong/"><div class="card-body"> <span class="timeago small" > Jul 13, 2022 <i class="unloaded">2022-07-13T22:55:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Android.bp makefile and soong</h3><div class="text-muted small"><p> Android编译系统，Android.bp、Soong以及Android.mk</p></div></div></a></div><div class="card"> <a href="/longan/posts/Android-HIDL-Example/"><div class="card-body"> <span class="timeago small" > Jul 14, 2022 <i class="unloaded">2022-07-14T00:55:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Android HAL 与 HIDL 开发实例</h3><div class="text-muted small"><p> Android 8.0之后，/dev/binder拓展多出了两个域，即/dev/hwbinder和/dev/vndbinder， /dev/hwbinder 主要用于 HIDL 接口的通信， /dev/vndbinder 则是用于 vendor 进程之间的 AIDL 通信。 作为 OEM/ODM 厂商，需要了解 Android 硬件的开发和集成流程，把自己硬件添加到 ROM ...</p></div></div></a></div><div class="card"> <a href="/longan/posts/Android.bp-syntax/"><div class="card-body"> <span class="timeago small" > Jul 20, 2022 <i class="unloaded">2022-07-20T23:55:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Android.bp syntax and usecase</h3><div class="text-muted small"><p> 在实际开发过程中，经常会遇到通过 宏/环境变量 判断是否加载某个模块，这时就需要进行条件编译。 Android 7.0 前使用 Android.mk 来编译模块，makefile 支持条件编译；但是 Android 7.0 之后逐步被 Android.bp 取代，Android.bp 本质上是 json 配置文件，不支持条件判断，所以 Google 提供了通过 go 语言来实现 Andro...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/longan/posts/Audio-Volume/" class="btn btn-outline-primary" prompt="Older"><p>audio volume</p></a> <a href="/longan/posts/Android.bp-makefile-soong/" class="btn btn-outline-primary" prompt="Newer"><p>Android.bp makefile and soong</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">CC</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/longan/tags/audio-playback/">audio playback</a> <a class="post-tag" href="/longan/tags/android-build-system/">android build system</a> <a class="post-tag" href="/longan/tags/android-hidl/">android HIDL</a> <a class="post-tag" href="/longan/tags/android-bp-syntax/">android.bp syntax</a> <a class="post-tag" href="/longan/tags/android-bp/">android.bp</a> <a class="post-tag" href="/longan/tags/array/">array</a> <a class="post-tag" href="/longan/tags/audio-framework/">audio framework</a> <a class="post-tag" href="/longan/tags/audio-playback-record/">audio playback/record</a> <a class="post-tag" href="/longan/tags/audio-stability/">audio stability</a> <a class="post-tag" href="/longan/tags/audio-volume/">audio volume</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/longan/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://fgroove.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
